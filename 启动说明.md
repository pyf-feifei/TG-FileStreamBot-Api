# TG-FileStreamBot å¯åŠ¨è¯´æ˜

## âœ… å½“å‰çŠ¶æ€

HTTPæœåŠ¡å™¨**å·²æˆåŠŸå¯åŠ¨**åœ¨ `http://localhost:8080`

ä½†æ˜¯Telegramå®¢æˆ·ç«¯è¿æ¥å¤±è´¥ï¼Œæ‰€ä»¥å®é™…æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æš‚æ—¶ä¸å¯ç”¨ã€‚

---

## ğŸ“Š ä¸‰ç§"Telegramè¿æ¥"çš„åŒºåˆ«

### 1. HTTPä»£ç†ï¼ˆå·²è®¾ç½®ä½†ä¸ç”Ÿæ•ˆï¼‰

```go
// proxy.go - åªå½±å“ http.DefaultClient
proxyURL, _ := url.Parse("http://127.0.0.1:7890")
client.Transport = &http.Transport{Proxy: http.ProxyURL(proxyURL)}
```

**ä½œç”¨èŒƒå›´**: ä»…HTTP/HTTPSè¯·æ±‚  
**ä¸å½±å“**: Telegram MTProtoè¿æ¥

### 2. Web Telegramï¼ˆCMDå¯è®¿é—®ï¼‰

```bash
curl https://web.telegram.org/  # âœ… æˆåŠŸ
```

**åŸå› **: ä½¿ç”¨HTTPSåè®® + ç³»ç»Ÿä»£ç†è®¾ç½®  
**åè®®**: HTTPS (HTTP over TLS)

### 3. Telegramå®¢æˆ·ç«¯ï¼ˆgotgprotoï¼‰âš ï¸

```go
// ä½¿ç”¨MTProtoåè®®ï¼Œä¸èµ°HTTPä»£ç†ï¼
gotgproto.NewClient(apiID, apiHash, ...)
```

**åè®®**: MTProto over TCP  
**é—®é¢˜**: æ²¡æœ‰é…ç½®ä»£ç†ï¼Œç›´è¿å¤±è´¥

---

## ğŸ”§ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šè®¾ç½®Goç¨‹åºçš„ä»£ç†ç¯å¢ƒå˜é‡ï¼ˆæ¨èï¼‰

åœ¨å¯åŠ¨ç¨‹åºå‰è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

```powershell
# PowerShell
$env:HTTP_PROXY="http://127.0.0.1:7890"
$env:HTTPS_PROXY="http://127.0.0.1:7890"
$env:ALL_PROXY="socks5://127.0.0.1:7890"  # å¦‚æœä»£ç†æ”¯æŒSOCKS5

.\fsb.exe run --dev
```

æˆ–è€…ï¼š

```powershell
# ä¸€è¡Œå‘½ä»¤
$env:ALL_PROXY="socks5://127.0.0.1:7890"; .\fsb.exe run --dev
```

### æ–¹æ¡ˆ2ï¼šä½¿ç”¨ç³»ç»Ÿçº§ä»£ç†

1. æ‰“å¼€Windowsè®¾ç½® â†’ ç½‘ç»œå’ŒInternet â†’ ä»£ç†
2. å¯ç”¨"ä½¿ç”¨ä»£ç†æœåŠ¡å™¨"
3. åœ°å€ï¼š`127.0.0.1`
4. ç«¯å£ï¼š`7890`
5. é‡å¯ç¨‹åº

### æ–¹æ¡ˆ3ï¼šå…³é—­DEVæ¨¡å¼ï¼ˆå¦‚æœåœ¨èƒ½ç›´è¿çš„ç¯å¢ƒï¼‰

ç¼–è¾‘ `fsb.env`:
```bash
# DEV=true  # æ³¨é‡Šæ‰è¿™è¡Œ
```

---

## ğŸ¯ å½“å‰å¯ç”¨çš„åŠŸèƒ½

å³ä½¿Telegramæœªè¿æ¥ï¼Œä»¥ä¸‹APIä»å¯æ­£å¸¸ä½¿ç”¨ï¼š

### 1. æœåŠ¡å™¨çŠ¶æ€

```powershell
Invoke-RestMethod http://localhost:8080/
```

### 2. ä¸Šä¼ çŠ¶æ€æŸ¥è¯¢

```powershell
Invoke-RestMethod -Uri "http://localhost:8080/upload/status" `
  -Headers @{Authorization="Bearer test-upload-token-123456789"}
```

### 3. ä¸Šä¼ æŒ‡æ ‡

```powershell
Invoke-RestMethod -Uri "http://localhost:8080/upload/metrics" `
  -Headers @{Authorization="Bearer test-upload-token-123456789"}
```

### 4. è®¤è¯æµ‹è¯•

```powershell
# é”™è¯¯çš„token - åº”è¯¥è¿”å›401
Invoke-RestMethod -Uri "http://localhost:8080/upload/status" `
  -Headers @{Authorization="Bearer wrong-token"}
```

---

## âš ï¸ ä¸å¯ç”¨çš„åŠŸèƒ½

ä»¥ä¸‹åŠŸèƒ½éœ€è¦Telegramè¿æ¥ï¼š

- âŒ å®é™…æ–‡ä»¶ä¸Šä¼  `POST /upload`
- âŒ æ‰¹é‡ä¸Šä¼  `POST /upload/batch`
- âŒ æ–‡ä»¶æµåª’ä½“è®¿é—® `GET /stream/:messageID`

---

## ğŸ§ª æµ‹è¯•ç»“æœ

### âœ… å·²éªŒè¯çš„åŠŸèƒ½

- [x] HTTPæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ
- [x] è·¯ç”±æ³¨å†Œæ­£ç¡®
- [x] è®¤è¯æœºåˆ¶å·¥ä½œæ­£å¸¸
- [x] é…é¢ç®¡ç†æ­£å¸¸
- [x] æŒ‡æ ‡ç»Ÿè®¡æ­£å¸¸
- [x] å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡

### âš ï¸ å¾…è§£å†³

- [ ] Telegram MTProtoè¿æ¥ï¼ˆéœ€è¦ä»£ç†é…ç½®ï¼‰

---

## ğŸ“ å¯åŠ¨æ—¥å¿—è§£è¯»

```
08/11/2025 05:25 PM     INFO    Main    Starting server
08/11/2025 05:25 PM     INFO    Config  Loaded config
08/11/2025 05:25 PM     INFO    Main    å¼€å‘æ¨¡å¼å·²å¯ç”¨ï¼Œæ­£åœ¨é…ç½®ä»£ç†è®¾ç½®
08/11/2025 05:25 PM     INFO    routes.Upload   æ­£åœ¨åŠ è½½ä¸Šä¼ è·¯ç”±...
08/11/2025 05:25 PM     INFO    routes.Upload   ä¸Šä¼ è·¯ç”±åŠ è½½å®Œæˆ
08/11/2025 05:25 PM     ERROR   Main    Failed to start main bot  â† âš ï¸ Telegramè¿æ¥å¤±è´¥
08/11/2025 05:25 PM     WARN    Main    âš ï¸  Telegramå®¢æˆ·ç«¯å¯åŠ¨å¤±è´¥ï¼Œä¸Šä¼ åŠŸèƒ½å°†ä¸å¯ç”¨
08/11/2025 05:25 PM     WARN    Main    âš ï¸  ä½†HTTPæœåŠ¡å™¨å°†ç»§ç»­å¯åŠ¨
08/11/2025 05:25 PM     INFO    Main    Server started  {"port": 8080}  â† âœ… HTTPæˆåŠŸå¯åŠ¨
[GIN-debug] Listening and serving HTTP on :8080  â† âœ… ç›‘å¬ä¸­
```

---

## ğŸ‰ æ€»ç»“

**HTTPä¸Šä¼ APIå¼€å‘å·²å®Œæˆï¼**

- âœ… ä»£ç å®ç°å®Œæ•´
- âœ… å•å…ƒæµ‹è¯•é€šè¿‡
- âœ… HTTPæœåŠ¡å™¨è¿è¡Œæ­£å¸¸
- âš ï¸ åªéœ€è§£å†³Telegramè¿æ¥å³å¯ä½¿ç”¨å®Œæ•´åŠŸèƒ½

**ä¸‹ä¸€æ­¥**ï¼šé…ç½®ç¯å¢ƒå˜é‡è®©Telegramå®¢æˆ·ç«¯èµ°ä»£ç†ã€‚

